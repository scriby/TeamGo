
<!DOCTYPE html>
<html lang="en" ng-app>
<head>
    <meta charset="utf-8">
    <title>Bootstrap, from Twitter</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
        body {
            padding-top: 60px;
            padding-bottom: 40px;
        }
    </style>
    <link href="/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/css/teamgo.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

</head>

<body>

<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a class="brand" href="#">Project name</a>
            <div class="nav-collapse">
                <ul class="nav">
                    <li class="active"><a href="#">Home</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </div><!--/.nav-collapse -->
        </div>
    </div>
</div>

<div class="container">

    <div class="game">
        <div>
            Black captures: <span data-bind="text: players.black.captures()"></span>
        </div>
        <div>
            White captures: <span data-bind="text: players.white.captures()"></span>
        </div>
        <div class="board" style="float:left" data-bind="foreach: rows">
            <div class="row" data-bind="foreach: $data">
                <div class="intersection" data-bind="click: click">
                    <div class="stone $data.status()"
                         data-bind="
                            css: {
                                white: status() === 'white',
                                black: status() === 'black'
                            }"

                    ></div>
                </div>
            </div>
        </div>
    </div>

    â€‹<div style="clear:both"></div>

    <hr>

    <footer>
        <p>&copy; Company 2012</p>
    </footer>

</div> <!-- /container -->

<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.js"></script>

<script type="text/javascript" src="/js/knockout.js"></script>
<script type="text/javascript" src="/js/EventEmitter.js"></script>
<script type="text/javascript" src="/js/controller/board.js"></script>

<script type="text/javascript" src="/nowjs/now.js"></script>
<script type="text/javascript" src="/js/raphael.js"></script>

<script type="text/javascript">
    (function(){
        var initialized = false;

        now.ready(function(){
            now.playMove = function(color, x, y){
                console.log(color + ',' + x + ',' + y);

                tg.board.playMove(color, x, y);
            };

            now.genMove = function(color, callback){
                console.log('genmove '  + color);

                //If the player got disconnected during his turn, the old event handler will still be around
                tg.board.events.removeAllListeners('intersectionClick');
                tg.board.events.on('intersectionClick', function(intersection){
                    if(tg.board.playMove(color, intersection.x, intersection.y)) {
                        tg.board.events.removeAllListeners('intersectionClick');
                        callback(null, intersection.x, intersection.y);
                    }
                });
            };

            now.clearBoard = function(){
                tg.board.clear();
            };

            now.join();

            if(!initialized){
                var gameRoot = $('.game')[0];
                ko.applyBindings(tg.board, gameRoot);

                initialized = true;
            }
        });
    })();
</script>

</body>
</html>
